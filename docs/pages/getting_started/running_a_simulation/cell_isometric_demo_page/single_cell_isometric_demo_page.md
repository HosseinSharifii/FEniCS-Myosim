---
title: Cell Isometric Twitch
parent: Demos
grand_parent: Getting Started
nav_order: 1
---

Summary
-------
A unit cube mesh consisting of six tetrahedral elements is used to model a single muscle cell tension response to a twitch calcium transient with fixed length. The instruction file is included in the repository, and can be downloaded <a href="https://github.com/MMoTH/FEniCS-Myosim/blob/master/demos/cell_isometric_demo/cell_displacement_ramp_and_hold_demo.json" >here</a>.

Simulation Protocol
-------------------
The muscle cell is stretched 10% over 20 ms so that the half-sarcomere length increases from 950 nm to 1045 nm. This stretch is maintained for 10 ms at a calcium concentration of 1e-7 M to allow the cross-bridges to approach steady state. Then the cell is activated with a skeletal muscle calcium transient approximation[^1] using the [two-compartment calcium](../../../model_formulations/calcium_models/two_compartment_model/two_compartment_model.md) model, and stretch held fixed. Cross-bridge mechanics are simulated using a three-state kinetic scheme[^2].

Boundary Conditions & Assumptions
---------------------------------
- Left face displacement is fixed in the x-direction.
- Right face displacement is prescribed to give the desired magnitude of stretch.
- A single point on the left face is completely fixed to prevent rigid body translation.
- The edges on the ends along the y and z-axes are constrained to remain along that axis to allow expansion/compression due to incompressibility while keeping the cross-section area square and prevent rigid-body rotation.
- The passive response is modeled as transversely isotropic using a combination of the Guccione strain energy function[^3] and one representing the myofiber response[^4]. More information about the passive stress formulation can be found [here](https://mmoth.github.io/FEniCS-Myosim/pages/model_formulations/tissue_mechanics/tissue_mechanics.html).
- Contraction is driven by the [three state kinetic scheme](https://mmoth.github.io/FEniCS-Myosim/pages/model_formulations/cell_mechanics/cell_mechanics.html).

Run the Simulation
------------------
To run the simulation, make sure Docker is running and enter the command line of your container by following the instructions [here](https://mmoth.github.io/FEniCS-Myosim/pages/getting_started/installation/installation.html#enter-container-command-line). Navigate to the directory containing the demo. Within Docker, this can be done by:  

```
cd /home/fenics/shared/demos/cell_isometric_demo/
```

Then execute the command  
```
python /home/fenics/shared/source_code/mmoth_vent.py cell_displacement_ramp_and_hold_demo.json
```
to run the simulation. This should create the directory "output/" within the current directory and save the results there.

Visualizing Results
-------------------
Two types of output are given by the simulations: sarcomere level results and system level results. The sarcomere level results include information needed for and calculated by MyoSim, and can be visualized by executing  
```
python path_to_k_plotter_npy.py 0 1
```
from the output directory (outside of the Docker container). This saves the animation seen below. The first number represents the index of the integration point to view results at (as indexed by FEniCS to minimize the bandwidth of the system matrix. Note this is <ins>not</ins> the same order as the indices of the vertices of the mesh. For more information about mapping between degrees of freedom and mesh coordinates, see [here](https://fenicsproject.org/pub/tutorial/html/._ftut1019.html). Below is a video of the plots generated by k_plotter_npy.py:

<video width="800" height="500" controls>
  <source src="test.mp4" type="video/mp4">
</video>

The bottom left animated panel shows the cross-bridge population over time. for a completely isometric twitch, the cross-bridge distributions are not strained and thus remain centered at x = 0.

The unit cube deformation is seen in Paraview, shown below. The left panel is colored according to half-sarcomere length and the right is colored by active stress. To visualize these results:

* Open Paraview, and select "Open" at the top left. Navigate to the output directory of the demo simulation.
* Load the "u_disp.pvd", "active_stress_magnitude.pvd", and "hsl_mesh.pvd" files.
* In the pipeline browser, click "Apply". The unit cube should appear.
* Hold shift and select all items in the "Pipeline Browser".
* Right click -> Add Filter -> Alphabetical -> Append Attributes.
* Click "Apply".  
* Either use the shortcut or Right click -> Add Filter -> Alphabetical -> Warp by Vector.
* click "Apply".

The cube can now be animated according to the displacement, and the coloring of the cube can be based on displacement, active stress generated in the fiber (**f0**) direction (shown in the below picture), or half-sarcomere length. **Note:** Visualizations in Paraview are a linear projection. Therefore displacement of midpoint nodes on the elements are not shown. Keep this in mind when using the unit cube for testing, as it is possible to misinterpret. For example, periodic boundary conditions are needed to simulate simple shear.

<video width="800" height="500" controls>
  <source src="cell_isometric_demo_animation.mp4" type="video/mp4">
</video>

<img src="https://github.com/mmoth-kurtis/MMotH-Vent/blob/master/docs/pages/getting_started/running_a_simulation/cell_isometric_demo_page/f0_cell_isometric_demo_2.png?raw=true" width="800" height="500">

[^1]: Baylor, S. M., & Hollingworth, S. (2003). Sarcoplasmic reticulum calcium release compared in slow-twitch and fast-twitch fibres of mouse muscle. J Physiol, 551(Pt 1), 125-138. doi:10.1113/jphysiol.2003.041608
[^2]: Mann, C. K., Lee, L. C., Campbell, K. S., & Wenk, J. F. (2020). Force-dependent recruitment from myosin OFF-state increases end-systolic pressure-volume relationship in left ventricle. Biomechanics and modeling in mechanobiology, 19(6), 2683–2692. https://doi.org/10.1007/s10237-020-01331-6
[^3]: Guccione, J. M., McCulloch, A. D., & Waldman, L. K. (1991). Passive material properties of intact ventricular myocardium determined from a cylindrical model. Journal of biomechanical engineering, 113(1), 42–55. https://doi.org/10.1115/1.2894084
[^4]: Xi, C., Kassab, G. S., & Lee, L. C. (2019). Microstructure-based finite element model of left ventricle passive inflation. Acta biomaterialia, 90, 241–253. https://doi.org/10.1016/j.actbio.2019.04.016
